<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fastcampus.web3.dao.CommentMapper">
  <!--  ì „ì²´ ëŒ“ê¸€ ì¡°íšŒ ìƒìˆ˜ë¡œ í™œìš©-->
  <sql id = "selectComment">
    SELECT *
    FROM COMMENT
  </sql>

  <!--  ðŸ“Œ ì „ì²´ ëŒ“ê¸€ ìˆ˜ ì¹´ìš´íŠ¸ -->
  <select id="countAll" resultType="Integer">
    SELECT COUNT(*)
    FROM COMMENT
  </select>

  <!--  ðŸ“Œ íŠ¹ì • ê²Œì‹œë¬¼ì˜ ëŒ“ê¸€ ìˆ˜ ì¹´ìš´íŠ¸ -->
  <select id="count" parameterType="CommentDTO" resultType="Integer">
    SELECT COUNT(*)
    FROM COMMENT
    WHERE bno = #{bno}
  </select>



  <!--  ðŸ“Œ ëŒ“ê¸€ ìƒì„±  -->
  <insert id="insert" parameterType="CommentDTO">
    INSERT INTO COMMENT(cno, bno, writer, content, reg_date, up_date)
    VALUES(#{cno}, #{bno}, #{writer}, #{content}, now(), now())
  </insert>

  <!--  ðŸ“Œ íŠ¹ì • ê²Œì‹œë¬¼ì˜ íŠ¹ì • ëŒ“ê¸€ ì¡°íšŒ -->
  <select id="select" parameterType="CommentDTO" resultType="CommentDTO">
    <include refid="selectComment"/>
    WHERE cno = #{cno} AND bno = #{bno}
  </select>

  <!--  ðŸ“Œ íŠ¹ì • ê²Œì‹œë¬¼ì˜ ëª¨ë“  ëŒ“ê¸€ ì¡°íšŒ -->
  <select id="selectAll" parameterType="CommentDTO" resultType="CommentDTO">
    <include refid="selectComment"/>
    WHERE bno = #{bno}
  </select>


  <!--  ðŸ“Œ íŠ¹ì • ëŒ“ê¸€ ìˆ˜ì • -->
  <update id="update" parameterType="CommentDTO">
    UPDATE COMMENT
    SET writer = #{writer}, content = #{content}, up_date = now()
    WHERE cno = #{cno} AND bno = #{bno}
  </update>

  <!--  ðŸ“Œ íŠ¹ì • ëŒ“ê¸€ ì‚­ì œ -->
  <delete id="delete" parameterType="CommentDTO">
    DELETE FROM COMMENT
    WHERE bno = #{bno} AND cno = #{cno}
  </delete>

  <!--  ðŸ“Œ íŠ¹ì • ê²Œì‹œê¸€ì˜ ëŒ“ê¸€ ëª¨ë‘ ì‚­ì œ -->
  <delete id="deleteAll" parameterType="Integer">
    DELETE FROM COMMENT
    WHERE bno = #{bno}
  </delete>
</mapper>